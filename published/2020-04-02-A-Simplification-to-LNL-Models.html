<!DOCTYPE html>
<html lang="en">
  <head>
        <title>A Simplification to LNL Models</title>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1">        
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="/includes/css/proofs.css" />
    <link rel="stylesheet" href="/includes/css/tables.css" />
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
  </head>
  <body>

    <!-- Wrap all page content here -->
    <div id="wrap" ng-app="HomePageApp">

      <!-- Fixed navbar -->
      <div class="navbar navbar-inverse" role="navigation">
        <div class="container-fluid" id="navfluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigationbar">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">hde.design</a>
          </div>
	  <div>
            <div class="collapse navbar-collapse" id="navigationbar">
              <ul class="nav navbar-nav">
                <li><a href="https://heades.github.io">Author</a></li>
                <li><a href="/">Posts</a></li>                
            </ul>
            </div>
          </div><!--/.nav-collapse -->
        </div>
      </div>

      <!-- Begin page content -->
      <div class="container">
        <div class="well">
          <h2>A Simplification to LNL Models</h2>
              Updated: 2020-04-10
        </div>
	<div class="row">
	  <div class="col-md-2">
	  </div>
	  <div class="col-md-10" style="font-size:20px;">
<div id="divCheckbox" style="display: none;">
  <span class="math display">
    \[    
    \newcommand{\ottnt}[1]{#1}
    \newcommand{\ottsym}[1]{#1}
    \newcommand{\ottmv}[1]{\mathit{#1}}

    \newcommand{\func}[1]{\mathsf{#1}}
    \newcommand{\Lin}[0]{\func{Lin}}
    \newcommand{\Mny}[0]{\func{Mny}}
    \newcommand{\Forget}[0]{\func{Forget}}
    \newcommand{\Free}[0]{\func{Free}}
    \newcommand{\Endo}[0]{\func{Endo}}
    \newcommand{\mto}[1]{\xrightarrow{#1}}
    \newcommand{\interp}[1]{[\negthinspace[#1]\negthinspace]}

    \newcommand{\cat}[1]{\mathcal{#1}}
    \newcommand{\catobj}[1]{\mathsf{Obj}(\cat{#1})}
    \newcommand{\Obj}[1]{\catobj{#1}}
    \newcommand{\catop}[1]{\cat{#1}^{\mathsf{op}}}
    \newcommand{\sets}[0]{\mathsf{Set}}
    \newcommand{\Set}[0]{\sets}
    \newcommand{\mor}[1]{\mathsf{Mor}(\cat{#1})}
    \newcommand{\Hom}[3]{\mathsf{Hom}_{#1}(#2,#3)}
    \newcommand{\cur}[0]{\mathsf{cur}}
    \newcommand{\curi}[0]{\mathsf{cur}^{-1}}
    \newcommand{\app}[0]{\mathsf{app}}
    \newcommand{\id}[0]{\mathsf{id}}
    \newcommand{\injl}[0]{\mathsf{inj_l}}
    \newcommand{\injr}[0]{\mathsf{inj_r}}
    \newcommand{\pow}[1]{\mathcal{P}(#1)}

    \newcommand{\oast}{&circledast;}
    \]
  </span>
</div>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#lnl-models">LNL Models</a></li>
<li><a href="#the-simplified-model">The Simplified Model</a></li>
</ul>
</nav>

<main>
  <div id="divCheckbox" style="display: none;">
  <p><span class="math display">\[
  \newcommand{\cat}[1]{\mathcal{#1}}
  \newcommand{\func}[1]{\mathsf{#1}}
  \newcommand{\Lin}[0]{\func{Lin}}
  \newcommand{\Mny}[0]{\func{Mny}}
  \newcommand{\Forget}[0]{\func{Forget}}
  \newcommand{\Free}[0]{\func{Free}}
  \newcommand{\mto}[0]{\to}
  \newcommand{\Hom}[3]{\mathsf{Hom}_{\cat{#1}}(#2,#3)}
  \newcommand{\interp}[1]{[\negthinspace[#1]\negthinspace]}
  \]</span></p>
  </div>
  <p>This is a known result that I’m using in some recent work I am writing up, and so I figured why not write a post about it.</p>
  <p>In this post I am going to explain a simplification to <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.36.5454&amp;rep=rep1&amp;type=pdf">Benton’s beautiful LNL models</a> that reduces their complexity, but retains their expressive power. I learned of this simplification from <a href="https://www.irif.fr/~mellies/">Paul-André Melliès’</a> writings. First, let’s take a look at the original definition of LNL models, and how they relate to linear categories.</p>
  <h2 id="lnl-models">LNL Models</h2>
  <p>A <strong>Linear/Non-Linear (LNL) model</strong> is an symmetric monoidal adjunction <span class="math display">\[\cat{C} : \Lin \dashv \Mny : \cat{M}\]</span>, where: - <span class="math display">\[\cat{C}\]</span> is a cartesian closed category, - <span class="math display">\[\cat{M}\]</span> is a symmetric monoidal closed category, - (Linear) <span class="math display">\[\Lin : \cat{C} \mto \cat{M}\]</span> is a symmetric monoidal functor, and - (Many) <span class="math display">\[\Mny : \cat{M} \mto \cat{C}\]</span> is a symmetric monoidal functor.</p>
  <p>Intuitively, we can think of <span class="math display">\[\cat{C}\]</span> as a model of intuitionistic logic (or the simply-typed <span class="math display">\[\lambda\]</span>-calculus), <span class="math display">\[\cat{M}\]</span> as a model of intuitionistic linear logic, and the functors <span class="math display">\[\Lin\]</span> and <span class="math display">\[\Mny\]</span> as modalities that allows one to translate formulas on one side to the other. The adjunction <span class="math display">\[\cat{C} : \Lin \dashv \Mny :
  \cat{M}\]</span> ensures that these translations are well behaved.</p>
  <p>LNL models are equivalent to Bierman’s linear categories. In fact, I wrote a <a href="/2018/07/24/Linear-Categories-A-Folklore-Simplification.html">blog post</a> in 2018 on a simplification to linear categories, so check that post out if you are unfamiliar with linear categories. The of-course modality of linear logic, denoted by <span class="math display">\[!A\]</span>, is characterized in linear categories by a symmetric monoidal comonad on a symmetric monoidal closed category. Benton showed that we can define the of-course modality as <span class="math display">\[!A = \Lin(\Mny\,A) : \cat{M} \mto \cat{M}\]</span>, and hence, is the comonad induced by the adjunction. Furthermore, since the adjunction is monoidal and between two symmetric monoidal functors, the induced comonad is symmetric monoidal as well.</p>
  <p>An extremely useful result shown by Benton is that the functor <span class="math display">\[\Lin :
  \cat{C} \mto \cat{M}\]</span> is strong monoidal; e.g., the following isomorphisms hold:</p>
  <p><span class="math display">\[
  \begin{array}{ll}
  \Lin \perp = I\\
  \Lin\,(X \times Y) = \Lin\,X \otimes \Lin\,Y
  \end{array}
  \]</span></p>
  <p>This is enough to ensure that the category <span class="math display">\[\cat{M}\]</span> with the induced comonad of the adjunction forms a linear category. Thus, LNL models imply linear categories, but the other direction is more interesting.</p>
  <p>Given a linear category <span class="math display">\[(\cat{L}, !, \varepsilon, \delta)\]</span> we need to find a cartesian closed category and a symmetric monoidal closed category that form an LNL model. It is well known that for any comonad <span class="math display">\[c : \cat{A} \mto \cat{A}\]</span> on some category <span class="math display">\[\cat{A}\]</span>, there are two adjunctions <span class="math display">\[\cat{A}^c : \Forget \dashv \Free : \cat{A}\]</span> and <span class="math display">\[\cat{A}_c : \Forget \dashv \Free : \cat{A}\]</span> between the category <span class="math display">\[\cat{A}\]</span> and the coEilenberg-Moore category – the category of <span class="math display">\[c\]</span>-coalgebras – and the Kleisli category – the category of free <span class="math display">\[c\]</span>-coalgebra respectively, where <span class="math display">\[\Forget(A,h_A) = A\]</span> and <span class="math display">\[\Free(A) = (!A,\delta_A)\]</span> are the forgetful and free functors. Benton showed that <span class="math display">\[\cat{L}^!\]</span> is cartesian, but it is not the case in general that <span class="math display">\[\cat{L}_!\]</span> is, because the product of two free coalgebras may not be free. Furthermore, neither of these are closed in general.</p>
  <p>To remedy these issues Benton found that the free coalgebras have an internal hom between them which is also free, and thus, by taking the full subcategory of <span class="math display">\[\cat{L}^!\]</span> of all the exponential objects – objects with an internal hom – then we get a cartesian closed category, and this full subcategory contains <span class="math display">\[\cat{L}_!\]</span>. Then he identifies a second cartesian closed category of all of the finite products of free coalgebras in the category of exponential objects. We can use either of these to form a LNL model.</p>
  <p>This is a lot of work to get an internal hom, but is it worth the work? Is it possible to ask for the category <span class="math display">\[\cat{C}\]</span> in the definition of LNL model to be simply cartesian, and then finding such a category from a linear category is easy, it’s <span class="math display">\[\cat{L}^!\]</span>. The answer turns out to be positive.</p>
  <h2 id="the-simplified-model">The Simplified Model</h2>
  <p>Taking the following simplified model we show that it implies a linear category, we do not show the opposite, because it follows as a corollary from the original proof summarized above.</p>
  <p>A <strong>Simplified Linear/Non-Linear (LNL) model</strong> is an <strong>adjunction</strong> <span class="math display">\[\cat{C} : \Lin \dashv \Mny : \cat{M}\]</span>, where: - <span class="math display">\[\cat{C}\]</span> is a <strong>cartesian category</strong>, - <span class="math display">\[\cat{M}\]</span> is a symmetric monoidal closed category, - (Linear) <span class="math display">\[\Lin : \cat{C} \mto \cat{M}\]</span> is a strong symmetric monoidal functor, and - (Many) <span class="math display">\[\Mny : \cat{M} \mto \cat{C}\]</span> <strong>is functor</strong>.</p>
  <p>In the above I highlight the simplifications which are actually generalizations. We can see that this definition removes the requirements that <span class="math display">\[\cat{C}\]</span> be closed, the adjunction be symmetric monoidal, and the functor <span class="math display">\[\Mny\]</span> be monoidal. This is nice, because generalizing the definition makes finding LNL models easier.</p>
  <p>The requirement that <span class="math display">\[\Lin\]</span> be strong symmetric monoidal paired with an adjunction is a particularly strong property. First, suppose <span class="math display">\[\cat{A} : \func{F} \dashv \func{G} : \cat{B}\]</span> is an adjunction between monoidal categories; so <span class="math display">\[\func{F}\]</span> and <span class="math display">\[\func{G}\]</span> are plan functors. The there are two really nice results:</p>
  <ol type="1">
  <li><p><a href="https://www.irif.fr/~mellies/mpri/mpri-ens/biblio/categorical-semantics-of-linear-logic.pdf">(p. 108, Proposition 12)</a> Every lax monoidal structure, <span class="math display">\[m : \func{F}X \otimes \func{F}Y \mto
  \func{F}(X \bullet Y)\]</span> on <span class="math display">\[\func{F} : \cat{A} \mto \cat{B}\]</span>, induces an oplax monoidal structure <span class="math display">\[n : \func{G}A \bullet \func{G}B
  \mto \func{G}(A \otimes B)\]</span> on <span class="math display">\[\func{G} : \cat{B} \mto \cat{A}\]</span>, and conversely. Furthermore, these mappings from <span class="math display">\[m\]</span> to <span class="math display">\[n\]</span> and back define an isomorphism giving a one-to-one relationship between the lax monoidal structure on one side of the adjunction and the other.</p></li>
  <li><p><a href="https://www.irif.fr/~mellies/mpri/mpri-ens/biblio/categorical-semantics-of-linear-logic.pdf">(p. 112, Proposition 14)</a> Suppose <span class="math display">\[(\func{F},m)\]</span> is lax monoidal. Then the adjunction <span class="math display">\[\cat{A} : \func{F} \dashv \func{G} : \cat{B}\]</span> lifts to a monoidal adjunction <span class="math display">\[(\cat{A},m) : \func{F} \dashv \func{G} : (\cat{B},p)\]</span> iff the lax monoidal functor <span class="math display">\[\func{F}\]</span> is strong. In the right-to-left case, the lax structure <span class="math display">\[p\]</span> is associated with <span class="math display">\[\func{G}\]</span> using part 1 and setting <span class="math display">\[n = m^{-1}\]</span>.</p></li>
  </ol>
  <p>We can add symmetry to the above properties, and they still hold. Thus, the second result above gives us a means of recovering a lax monoidal structure on the functor <span class="math display">\[\Mny : \cat{M} \mto \cat{C}\]</span>. Therefore, simplified LNL models imply the following definition:</p>
  <p>A <strong>Semi-simplified Linear/Non-Linear (SSLNL) model</strong> is an symmetric monoidal adjunction <span class="math display">\[\cat{C} : \Lin \dashv \Mny : \cat{M}\]</span>, where: - <span class="math display">\[\cat{C}\]</span> is a <strong>cartesian category</strong>, - <span class="math display">\[\cat{M}\]</span> is a symmetric monoidal closed category, - (Linear) <span class="math display">\[\Lin : \cat{C} \mto \cat{M}\]</span> is a strong symmetric monoidal functor, and - (Many) <span class="math display">\[\Mny : \cat{M} \mto \cat{C}\]</span> is a symmetric monoidal functor.</p>
  <p>Showing that this definition implies a linear category is easy, we can just use <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.36.5454&amp;rep=rep1&amp;type=pdf">Benton’s proof (p. 16, Section 2.2.1)</a>. Thus, the simplified definition of a LNL model implies linear category.</p>
  <p>At this point the only question left is, but what about non-linear implications / functions? In the original model the cartesian closed category is a model of non-linear logic / simply-type <span class="math display">\[\lambda\]</span>-calculus and on the other side we have a model of linear logic. Can we still obtain an encoding of non-linear logic using the simplified definition?</p>
  <p>We can indeed by first exploiting the adjunction and the fact that <span class="math display">\[\cat{M}\]</span> is closed. Let <span class="math display">\[X\]</span> and <span class="math display">\[B\]</span> be objects in <span class="math display">\[\cat{C}\]</span> and <span class="math display">\[\cat{M}\]</span> respectively. Then define the object:</p>
  <p><span class="math display">\[X \Rightarrow B := \Lin\,X \multimap B\]</span></p>
  <p>Then there is a bijection:</p>
  <p><span class="math display">\[
  \begin{array}{llll}
  \Hom{C}{X \bullet Y}{\Mny\,B}
  &amp; \cong &amp; \Hom{M}{\Lin(X \bullet Y)}{B} \\
  &amp; \cong &amp; \Hom{M}{\Lin\,X \otimes \Lin\,Y)}{B} \\
  &amp; \cong &amp; \Hom{M}{\Lin\,X}{\Lin\,Y \multimap B} \\
  &amp; = &amp; \Hom{M}{\Lin\,X}{Y \Rightarrow B} \\
  &amp; \cong &amp; \Hom{C}{X}{\Mny\,(Y \Rightarrow B)}
  \end{array}
  \]</span></p>
  <p>This is a kind of currying, and is enough to interpret non-linear logic where we encode the formulas in the form of <span class="math display">\[\Mny\,A\]</span> for linear formulas <span class="math display">\[A\]</span> in <span class="math display">\[\cat{M}\]</span>. In more detail, the interpretation is in the form of a faithful functor defined on types as follows:</p>
  <p><span class="math display">\[
  \begin{array}{ll}
  \interp{\top} = I\\
  \interp{A \times B} = \interp{A} \otimes \interp{B}\\
  \interp{A \Rightarrow B} = (\Lin\,\Mny\,\interp{A} \multimap \interp{B})
  \end{array}
  \]</span></p>
  <p>Then sequents <span class="math display">\[x_1 : A_1, \cdots, x_i : A_i \vdash t : b\]</span> are interpreted as morphisms from <span class="math display">\[\Mny\,\interp{A_1} \bullet \cdots \bullet
  \Mny\,\interp{A_i}\]</span> to <span class="math display">\[\Mny\,\interp{B}\]</span>.</p>
  <p>Using this we can show that every equation in the theory is preserved by the interpretation. This proves that the interpretation soundly models the theory in an LNL model. Faithfulness ensures that every proof is caputed by our model.</p>
  <p>This simplifies the model a lot, but how does it affect the syntactic side of things? Well, we get to remove the rules for non-linear implication, and derieve them which is appealing both theoretically and practically.</p>
</main>
            <hr>
            <p>
                        <em>Leave a comment by sending me an <a href="mailto:harley.eades@gmail.com">Email</a></em>
                        </p>
	  <div class="col-md-1">
	  </div>
	</div>
      </div>
    </div>

    <div id="footer">
      <div class="container">
	<p class="text-right" class="text-muted credit">	
	</p>
      </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
     <script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

       ga('create', 'UA-71081670-1', 'auto');
       ga('send', 'pageview');
     </script>
  </body>
</html>
