<!DOCTYPE html>
<html lang="en">
  <head>
        <title>Some notes on programming with Linear Haskell</title>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1">        
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="/includes/css/proofs.css" />
    <link rel="stylesheet" href="/includes/css/tables.css" />
  </head>
  <body>

    <!-- Wrap all page content here -->
    <div id="wrap" ng-app="HomePageApp">

      <!-- Fixed navbar -->
      <div class="navbar navbar-inverse" role="navigation">
        <div class="container-fluid" id="navfluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigationbar">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">hde.design</a>
          </div>
	  <div>
            <div class="collapse navbar-collapse" id="navigationbar">
              <ul class="nav navbar-nav">
                <li><a href="https://heades.github.io">Author</a></li>
                <li><a href="/">Posts</a></li>                
            </ul>
            </div>
          </div><!--/.nav-collapse -->
        </div>
      </div>

      <!-- Begin page content -->
      <div class="container">
        <div class="well">
          <h2>Some notes on programming with Linear Haskell</h2>
              Updated: 2025-08-20
        </div>
	<div class="row">
	  <div class="col-md-2">
	  </div>
	  <div class="col-md-10" style="font-size:20px;">
<div id="divCheckbox" style="display: none;">
  <span class="math display">
    \[    
    \newcommand{\ottnt}[1]{#1}
    \newcommand{\ottsym}[1]{#1}
    \newcommand{\ottmv}[1]{\mathit{#1}}

    \newcommand{\func}[1]{\mathsf{#1}}
    \newcommand{\Lin}[0]{\func{Lin}}
    \newcommand{\Mny}[0]{\func{Mny}}
    \newcommand{\Forget}[0]{\func{Forget}}
    \newcommand{\Free}[0]{\func{Free}}
    \newcommand{\Endo}[0]{\func{Endo}}
    \newcommand{\mto}[1]{\xrightarrow{#1}}
    \newcommand{\interp}[1]{[\negthinspace[#1]\negthinspace]}

    \newcommand{\cat}[1]{\mathcal{#1}}
    \newcommand{\catobj}[1]{\mathsf{Obj}(\cat{#1})}
    \newcommand{\Obj}[1]{\catobj{#1}}
    \newcommand{\catop}[1]{\cat{#1}^{\mathsf{op}}}
    \newcommand{\sets}[0]{\mathsf{Set}}
    \newcommand{\Set}[0]{\sets}
    \newcommand{\mor}[1]{\mathsf{Mor}(\cat{#1})}
    \newcommand{\Hom}[3]{\mathsf{Hom}_{#1}(#2,#3)}
    \newcommand{\cur}[0]{\mathsf{cur}}
    \newcommand{\curi}[0]{\mathsf{cur}^{-1}}
    \newcommand{\app}[0]{\mathsf{app}}
    \newcommand{\id}[0]{\mathsf{id}}
    \newcommand{\injl}[0]{\mathsf{inj_l}}
    \newcommand{\injr}[0]{\mathsf{inj_r}}
    \newcommand{\pow}[1]{\mathcal{P}(#1)}

    \newcommand{\oast}{&circledast;}
    \]
  </span>
</div>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#using-linear-types-in-haskell"
id="toc-using-linear-types-in-haskell">Using Linear Types in
Haskell</a></li>
<li><a href="#linear-base" id="toc-linear-base">Linear Base</a></li>
<li><a href="#renaming-the-linear-bound-type-annotations"
id="toc-renaming-the-linear-bound-type-annotations">Renaming the linear
bound type annotations</a></li>
<li><a href="#useful-links" id="toc-useful-links">Useful Links</a></li>
</ul>
</nav>

<main>
  <p>So I’m learning about Linear Haskell for some new project ideas I
  have brewing, and I thought, why not just add it to a note on the OLD
  blog! It took me a day to get this thing dusted off and building
  again, but after a few updates to my hella-hacked Haskell blogging
  tools I use on the backend, I managed to get this thing up and running
  again.</p>
  <p><strong>Warning:</strong> This is really just something for me to
  use to think and refer back to later; don’t expect greatness or
  polished writing.</p>
  <h1 id="using-linear-types-in-haskell">Using Linear Types in
  Haskell</h1>
  <p>Using linear types in GHC is pretty easy; as long as you are using
  a GHC version of at least 9.0.1. Simply add the following language
  extension to the files you plan on using them in:</p>
  <pre><code>{-# LANGUAGE LinearTypes #-}</code></pre>
  <p>One nice features of Cabal is that you can add default language
  extensions that will be applied to all files in your project without
  having to add them to each file. Add the following to your cabal file
  under the executable or library (or both) configurations:</p>
  <pre><code>-- LANGUAGE extensions used by modules in this package.
default-extensions:     LinearTypes                        </code></pre>
  <p>You can add others to this field as well (as a comma separated
  list).</p>
  <h1 id="linear-base">Linear Base</h1>
  <p>There is an ongoing effort to bring linear types to the Haskell
  Base by Tweag they are calling <a
  href="https://hackage-content.haskell.org/package/linear-base-0.5.0">Linear
  Base</a>. The idea is that it makes programming with linear types
  easier by importing some of the basic facilities found in the Haskell
  standard library into the linear world by adding linear bounds to the
  definitions, and adding some new support for new abstractions based on
  linear types.</p>
  <p>To make it easier to work with linear base I found it easier to add
  the following language extensions.</p>
  <pre><code>-- LANGUAGE extensions used by modules in this package.
default-extensions:     LinearTypes, 
                        DataKinds,
                        QualifiedDo, 
                        NoImplicitPrelude</code></pre>
  <p>When using linear base we want to default to it’s prelude
  <code>Prelude.Linear</code>. Thus, having the non-linear prelude
  qualified we can more easily control when to use non-linearity. For
  example, I qualify mine as follows:</p>
  <pre><code>-- Our Prelude is Linear by default:
import Prelude.Linear
import qualified Prelude as NLPrelude</code></pre>
  <p>This way I can see in my code when I’m using non-linear
  features.</p>
  <h1 id="renaming-the-linear-bound-type-annotations">Renaming the
  linear bound type annotations</h1>
  <p>I thought this was pretty cool! Because of the choice to make the
  linear bounds Haskell datatypes, we can simply alias them to different
  constructors to give them names we might like for the project we are
  using them for:</p>
  <pre><code>import GHC.Types (Multiplicity(..))

data LNLMult = Linear | Nonlinear

type Linear = One
type NonLinear = Many</code></pre>
  <p>Now we can annotate our types with the new names:</p>
  <pre><code>linearId :: a %Linear -&gt; a
linearId x = x</code></pre>
  <h1 id="useful-links">Useful Links</h1>
  <ul>
  <li><a
  href="https://ghc.gitlab.haskell.org/ghc/doc/users_guide/exts/linear_types.html">GHC
  Docs: Linear Types Extension</a></li>
  <li><a
  href="https://hackage-content.haskell.org/package/linear-base-0.5.0">Hackage:
  Linear Base</a></li>
  <li><a href="https://dl.acm.org/doi/10.1145/3158093">Paper: Linear
  Haskell: practical linearity in a higher-order polymorphic
  language</a></li>
  <li><a href="https://dl.acm.org/doi/10.1145/3547626">Paper: Linearly
  qualified types: generic inference for capabilities and
  uniqueness</a></li>
  </ul>
</main>
            <hr>
            <p>
                        <em>Leave a comment by sending me an <a href="mailto:harley.eades@gmail.com">Email</a></em>
                        </p>
	  <div class="col-md-1">
	  </div>
	</div>
      </div>
    </div>

    <div id="footer">
      <div class="container">
	<p class="text-right" class="text-muted credit">	
	</p>
      </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
     <script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

       ga('create', 'UA-71081670-1', 'auto');
       ga('send', 'pageview');
     </script>
  </body>
</html>
